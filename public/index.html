<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ— ç•å¥‘çº¦ç‹‚å¾’ç‰¹æ•ˆæªçš®è¯„çº§</title>
    <style>
        /* ===================== å…¨å±€æ ·å¼ ===================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* å…¨å±€ç¼©æ”¾æ ¸å¿ƒæ ·å¼ - é€‚é…æ•´ä½“æ˜¾ç¤ºæ¯”ä¾‹ */
        body {
            transform: scale(0.8);
            transform-origin: 0 0;
            width: 130%;
            min-height: 130vh;
            margin: 0;
            padding: 0;
        }

        /* å…¼å®¹æ—§ç‰ˆChromeç¼©æ”¾ï¼ˆç°ä»£æµè§ˆå™¨å¯çœç•¥ï¼‰ */
        @media screen and (-webkit-min-device-pixel-ratio: 0) {
            body {
                zoom: 0.8;
            }
        }

        /* é¡µé¢åŸºç¡€æ ·å¼ */
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0e17 0%, #1a1a2e 50%, #16213e 100%);
            background-attachment: fixed;
            color: #fff;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0;
            padding: 0;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            text-align: center;
            font-size: 2.8em;
            margin: 20px 0 8px 0;
            background: linear-gradient(90deg, #ff4655, #ff8a00, #ff4655);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            letter-spacing: 2px;
            text-shadow: 0 0 30px rgba(255, 70, 85, 0.3);
        }

        .subtitle {
            text-align: center;
            color: #b8b8d1;
            margin-bottom: 20px;
            font-size: 1.05em;
            font-weight: 300;
            letter-spacing: 1px;
        }

        /* ===================== ä¸»å†…å®¹åŒºæ ·å¼ ===================== */
        .main-content {
            display: flex;
            gap: 0;
            margin: 0;
            padding: 0;
            width: 100%;
            height: auto;
        }

        /* å¾…é€‰åŒºæ ·å¼ */
        .waiting-area {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.03) 100%);
            border-left: 3px solid rgba(255, 138, 0, 0.4);
            padding: 20px 18px;
            width: 33.33%;
            flex: 1;
            height: auto;
            display: flex;
            flex-direction: column;
            box-shadow: -8px 0 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            aspect-ratio: auto;
            max-height: none;
        }

        .waiting-area h2 {
            color: #fff;
            margin-bottom: 16px;
            font-size: 1.3em;
            flex-shrink: 0;
            font-weight: 600;
            text-align: center;
            background: linear-gradient(90deg, #ff8a00, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* æªçš®åˆ—è¡¨æ ·å¼ */
        .skin-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 8px;
            align-content: flex-start;
            justify-content: flex-start;
        }

        /* æªçš®åˆ—è¡¨æ»šåŠ¨æ¡æ ·å¼ */
        .skin-list::-webkit-scrollbar {
            width: 6px;
        }

        .skin-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

        .skin-list::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #ff4655, #ff8a00);
            border-radius: 3px;
        }

        .skin-list::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #ff6675, #ffa520);
        }

        /* æªçš®å¡ç‰‡æ ·å¼ */
        .skin-card {
            background: linear-gradient(135deg, #2d3561 0%, #1f2647 100%);
            padding: 10px 14px;
            border-radius: 10px;
            cursor: grab;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid rgba(255, 255, 255, 0.15);
            font-size: 0.85em;
            user-select: none;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            white-space: nowrap;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .skin-card-img {
            width: 100%;
            height: auto;
            max-height: 75px;
            object-fit: contain;
            border-radius: 30px;
            pointer-events: none;
        }

        /* æªçš®å¡ç‰‡äº¤äº’æ ·å¼ */
        .skin-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 70, 85, 0.4);
            border-color: rgba(255, 70, 85, 0.6);
            background: linear-gradient(135deg, #353d6f 0%, #252b55 100%);
        }

        .skin-card:active {
            transform: scale(0.98);
        }

        .skin-card.dragging {
            opacity: 0.6;
            cursor: grabbing;
            transform: rotate(3deg);
            position: relative;
            z-index: 9999;
        }

        /* è¯„çº§åŒºæ ·å¼ */
        .rating-area {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 66.67%;
            flex: 2;
            min-height: 200px;
            height: auto;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
        }

        /* è¯„çº§ç›’å­åŸºç¡€æ ·å¼ */
        .rating-box {
            border-radius: 12px;
            padding: 12px 20px;
            flex: none;
            height: auto;
            min-height: 200px;
            border: 3px solid;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        .rating-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: inherit;
            opacity: 0.1;
            z-index: 0;
        }

        .rating-box > * {
            position: relative;
            z-index: 1;
        }

        /* è¯„çº§ç›’å­æ‹–æ”¾äº¤äº’æ ·å¼ */
        .rating-box.drag-over {
            transform: scale(1.02);
            box-shadow: 0 0 30px currentColor, 0 8px 24px rgba(0, 0, 0, 0.4);
            border-width: 4px;
        }

        .rating-box h3 {
            text-align: center;
            font-size: 2em;
            margin-bottom: 8px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 2px 10px currentColor;
            flex-shrink: 0;
        }

        /* å„è¯„çº§ç›’å­é…è‰²æ ·å¼ */
        .rating-box.s-tier {
            border-color: #ff4655;
            background: linear-gradient(135deg, rgba(255, 70, 85, 0.15) 0%, rgba(255, 70, 85, 0.05) 100%);
        }

        .rating-box.s-tier h3,
        .rating-box.s-tier .skin-card {
            color: #ff4655;
            border-color: #ff4655;
        }

        .rating-box.a-tier {
            border-color: #ffd700;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 215, 0, 0.05) 100%);
        }

        .rating-box.a-tier h3,
        .rating-box.a-tier .skin-card {
            color: #ffd700;
            border-color: #ffd700;
        }

        .rating-box.b-tier {
            border-color: #a855f7;
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.15) 0%, rgba(168, 85, 247, 0.05) 100%);
        }

        .rating-box.b-tier h3,
        .rating-box.b-tier .skin-card {
            color: #a855f7;
            border-color: #a855f7;
        }

        .rating-box.c-tier {
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.05) 100%);
        }

        .rating-box.c-tier h3,
        .rating-box.c-tier .skin-card {
            color: #3b82f6;
            border-color: #3b82f6;
        }

        .rating-box.d-tier {
            border-color: #10b981;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%);
        }

        .rating-box.d-tier h3,
        .rating-box.d-tier .skin-card {
            color: #10b981;
            border-color: #10b981;
        }

        /* æ‹–æ”¾åŒºåŸŸæ ·å¼ */
        .drop-zone {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            min-height: auto;
            align-content: flex-start;
            flex: none;
            overflow: hidden;
            padding: 4px;
            height: auto;
            min-height: 80px;
        }

        /* æ‹–æ”¾åŒºåŸŸæ»šåŠ¨æ¡æ ·å¼ï¼ˆå³ä½¿ä¸æ˜¾ç¤ºï¼‰ */
        .drop-zone::-webkit-scrollbar {
            width: 4px;
        }

        .drop-zone::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }

        .drop-zone::-webkit-scrollbar-thumb {
            background: currentColor;
            opacity: 0.3;
            border-radius: 2px;
        }

        .drop-zone .skin-card {
            font-size: 0.8em;
            padding: 8px 12px;
            white-space: nowrap;
        }

        /* ===================== æŒ‰é’®æ ·å¼ ===================== */
        .submit-btn {
            display: block;
            margin: 20px auto;
            padding: 16px 60px;
            font-size: 1.15em;
            font-weight: 700;
            background: linear-gradient(135deg, #ff4655 0%, #ff8a00 100%);
            border: none;
            border-radius: 12px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 6px 20px rgba(255, 70, 85, 0.4);
            position: relative;
            overflow: hidden;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .submit-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 70, 85, 0.6);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            background: linear-gradient(135deg, #555 0%, #444 100%);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .back-btn {
            display: inline-block;
            margin-bottom: 20px;
            padding: 10px 25px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: #fff;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff4655;
        }

        /* ===================== æ¶ˆæ¯æç¤ºæ ·å¼ ===================== */
        .message {
            text-align: center;
            padding: 16px 24px;
            margin: 20px auto;
            border-radius: 12px;
            font-size: 1.05em;
            max-width: 600px;
            font-weight: 500;
            backdrop-filter: blur(10px);
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.error {
            background: rgba(255, 70, 85, 0.25);
            border: 2px solid #ff4655;
            box-shadow: 0 4px 16px rgba(255, 70, 85, 0.3);
        }

        .message.success {
            background: rgba(16, 185, 129, 0.25);
            border: 2px solid #10b981;
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);
        }

        /* ===================== æ’åé¡µé¢æ ·å¼ ===================== */
        .ranking-page {
            display: none;
        }

        .ranking-page.active {
            display: block;
        }

        .ranking-list {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .ranking-item {
            position: relative;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #ff4655;
            transition: all 0.3s ease;
            overflow: hidden;
            background: linear-gradient(135deg, #2d3561 0%, #1f2647 100%);
            /* CSSå˜é‡æ‰¿è½½èƒŒæ™¯å›¾ï¼Œè¡¥å……èƒŒæ™¯åŸºç¡€å±æ€§ */
            background-image: var(--bg-image, none);
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
        }

        .ranking-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            /* æ›¿æ¢inheritä¸ºCSSå˜é‡ï¼Œç¡®ä¿èƒŒæ™¯å›¾æ­£ç¡®è¯»å– */
            background-image: var(--bg-image, none);
            background-size: cover;
            background-position: center;
            /* è¡¥å……èƒŒæ™¯é‡å¤å±æ€§ï¼Œé¿å…å›¾è£‚ */
            background-repeat: no-repeat;
            filter: blur(0.1px) brightness(0.9);
            z-index: 0;
            opacity: 0.7;
        }

        .ranking-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(45, 53, 97, 0.85) 0%, 
                rgba(31, 38, 71, 0.9) 100%);
            z-index: 1;
        }

        .ranking-item > * {
            position: relative;
            z-index: 2;
        }

        .ranking-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(255, 70, 85, 0.3);
        }

        .ranking-item .rank {
            font-size: 2em;
            font-weight: bold;
            color: #ffd700;
            display: inline-block;
            width: 60px;
        }

        .ranking-item .skin-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
        }

        .ranking-item .total-score {
            font-size: 1.5em;
            color: #ff4655;
            font-weight: bold;
            margin: 10px 0;
        }

        .rating-stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .stat-item {
            padding: 5px 12px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .stat-s { background: rgba(255, 70, 85, 0.2); color: #ff4655; }
        .stat-a { background: rgba(255, 215, 0, 0.2); color: #ffd700; }
        .stat-b { background: rgba(168, 85, 247, 0.2); color: #a855f7; }
        .stat-c { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .stat-d { background: rgba(16, 185, 129, 0.2); color: #10b981; }

        /* ===================== å“åº”å¼æ ·å¼ ===================== */
        @media (max-width: 1200px) {
            .main-content {
                flex-direction: column;
                height: auto;
                min-height: auto;
            }

            .rating-area {
                width: 100%;
                height: auto;
                min-height: auto;
            }

            .waiting-area {
                width: 100%;
                height: auto;
                aspect-ratio: auto;
                max-height: none;
                border-left: none;
                border-top: 3px solid rgba(255, 138, 0, 0.4);
            }

            .rating-box {
                min-height: auto;
            }

            .skin-list {
                gap: 10px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 0;
            }

            h1 {
                font-size: 2em;
                margin: 15px 0 5px 0;
            }

            .subtitle {
                font-size: 0.95em;
                margin-bottom: 15px;
            }

            .main-content {
                height: auto;
            }

            .rating-area {
                width: 100%;
                padding: 10px;
                min-height: auto;
            }

            .rating-box {
                padding: 10px 15px;
            }

            .rating-box h3 {
                font-size: 1.6em;
            }

            .waiting-area {
                width: 100%;
                height: auto;
                padding: 15px 12px;
            }

            .skin-list {
                gap: 8px;
            }

            .skin-card {
                font-size: 0.8em;
                padding: 9px 12px;
            }

            .submit-btn {
                padding: 14px 40px;
                font-size: 1em;
                margin: 15px auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- è¯„çº§é¡µé¢ -->
        <div id="ratingPage">
            <h1>ğŸ® æ— ç•å¥‘çº¦ç‹‚å¾’ç‰¹æ•ˆæªçš®è¯„çº§</h1>
            <p class="subtitle">æ‹–æ‹½æªçš®åˆ°å¯¹åº”ç­‰çº§å®Œæˆè¯„çº§</p>

            <div id="messageBox"></div>

            <!-- ä¸»å†…å®¹åŒº -->
            <div class="main-content">
                <!-- è¯„çº§é€‰æ‹©åŒº -->
                <div class="rating-area">
                    <div class="rating-box s-tier" data-tier="S">
                        <h3>S</h3>
                        <div class="drop-zone" data-tier="S"></div>
                    </div>
                    <div class="rating-box a-tier" data-tier="A">
                        <h3>A</h3>
                        <div class="drop-zone" data-tier="A"></div>
                    </div>
                    <div class="rating-box b-tier" data-tier="B">
                        <h3>B</h3>
                        <div class="drop-zone" data-tier="B"></div>
                    </div>
                    <div class="rating-box c-tier" data-tier="C">
                        <h3>C</h3>
                        <div class="drop-zone" data-tier="C"></div>
                    </div>
                    <div class="rating-box d-tier" data-tier="D">
                        <h3>D</h3>
                        <div class="drop-zone" data-tier="D"></div>
                    </div>
                </div>

                <!-- å¾…é€‰åŒº -->
                <div class="waiting-area">
                    <h2>ğŸ“¦ å¾…é€‰åŒº</h2>
                    <div class="skin-list" id="waitingArea"></div>
                </div>
            </div>

            <button class="submit-btn" id="submitBtn">æäº¤è¯„çº§</button>
        </div>

        <!-- æ’åé¡µé¢ -->
        <div id="rankingPage" class="ranking-page">
            <h1>ğŸ† å…¨ç½‘æªçš®è¯„çº§æ’è¡Œæ¦œ TOP 10</h1>
            <p class="subtitle">åŸºäºå…¨ä½“ç©å®¶è¯„çº§æ•°æ®ç»Ÿè®¡</p>
            
            <a href="#" class="back-btn" id="backBtn">â† è¿”å›è¯„çº§é¡µé¢</a>
            
            <div class="ranking-list" id="rankingList"></div>
        </div>
    </div>

    <script>
        /**************************
         * å¸¸é‡å®šä¹‰åŒº - åŸºç¡€é…ç½®æ•°æ®
         **************************/
        // æªçš®åç§°åˆ—è¡¨
        const SKINS = [
            "RGX 11z Pro", "æ å½±", "ç›–äºšçš„å¤ä»‡", "ç´«é˜™é‡‘ç…", "ORA x é¢—ç§’",
            "è‰¾æ²ƒè‰çš„æ¢¦ä¹‹ç¿¼", "è¶…æ—¶ç©ºå«é˜Ÿ", "ä¸Šå¤é¾™ç‚", "2021 å…¨çƒå† å†›èµ›", "2023 å…¨çƒå† å†›èµ›",
            "2025 å…¨çƒå† å†›èµ›", "åˆ›ãƒ»çºªå…ƒ", "å¤šå¼¥å°”çš„å¤ä»‡", "å…‰æ˜å“¨å…µ", "å…‰è£å¼‚è±¡",
            "å½’é›¶è€…", "æ´ªè’æ€’ç„°", "æ··æ²Œåºæ›²", "æœºåŠ¨ç‹‚é£™", "å¥‡ç‚¹ //2.0",
            "åƒçµåç»½ //2.0", "å™¬å½±è€…", "åŒåŸä¹‹æˆ˜", "å¡‘æ°´å®—", "å…¨æ¯æ³¢æ™® //2.0",
            "è™šç©ºé—è¿¹", "åƒæœˆè‹é¾™", "æ»‹æ»‹ X ç‰¹å·¥é˜Ÿ", "èˆ¬è‹¥å‡é¢ //2.0", "å†°ç‚¹å‡å†»",
            "å •å¤©é—æ­¦", "ç›–ä¸–è‹±é›„", "æµ·æ´‹ä¹‹æ˜Ÿ", "ç¦»å­æ­¦å™¨ //2.0", "æ—¥å†•é›„ç‹®",
            "å¥‡å¹»æœ‹å…‹ //3.0", "èµ·æº", "è€€é³å¨é¾™"
        ];

        // æªçš®å›¾ç‰‡è·¯å¾„æ˜ å°„
        const SKIN_IMAGE_MAP = {
            "RGX 11z Pro": "skin/skin03.png",
            "æ å½±": "skin/skin02.png",
            "ç›–äºšçš„å¤ä»‡": "skin/skin04.png",
            "ç´«é˜™é‡‘ç…": "skin/skin05.png",
            "ORA x é¢—ç§’": "skin/skin06.png",
            "è‰¾æ²ƒè‰çš„æ¢¦ä¹‹ç¿¼": "skin/skin07.png",
            "è¶…æ—¶ç©ºå«é˜Ÿ": "skin/skin08.png",
            "ä¸Šå¤é¾™ç‚": "skin/skin09.png",
            "2021 å…¨çƒå† å†›èµ›": "skin/skin10.png",
            "2023 å…¨çƒå† å†›èµ›": "skin/skin11.png",
            "2025 å…¨çƒå† å†›èµ›": "skin/skin12.png",
            "åˆ›ãƒ»çºªå…ƒ": "skin/skin13.png",
            "å¤šå¼¥å°”çš„å¤ä»‡": "skin/skin01.png",
            "å…‰æ˜å“¨å…µ": "skin/skin14.png",
            "å…‰è£å¼‚è±¡": "skin/skin15.png",
            "å½’é›¶è€…": "skin/skin16.png",
            "æ´ªè’æ€’ç„°": "skin/skin17.png",
            "æ··æ²Œåºæ›²": "skin/skin18.png",
            "æœºåŠ¨ç‹‚é£™": "skin/skin19.png",
            "å¥‡ç‚¹ //2.0": "skin/skin20.png",
            "åƒçµåç»½ //2.0": "skin/skin21.png",
            "å™¬å½±è€…": "skin/skin37.png",
            "åŒåŸä¹‹æˆ˜": "skin/skin36.png",
            "å¡‘æ°´å®—": "skin/skin35.png",
            "å…¨æ¯æ³¢æ™® //2.0": "skin/skin38.png",
            "è™šç©ºé—è¿¹": "skin/skin34.png",
            "åƒæœˆè‹é¾™": "skin/skin33.png",
            "æ»‹æ»‹ X ç‰¹å·¥é˜Ÿ": "skin/skin32.png",
            "èˆ¬è‹¥å‡é¢ //2.0": "skin/skin31.png",
            "å†°ç‚¹å‡å†»": "skin/skin30.png",
            "å •å¤©é—æ­¦": "skin/skin29.png",
            "ç›–ä¸–è‹±é›„": "skin/skin28.png",
            "æµ·æ´‹ä¹‹æ˜Ÿ": "skin/skin27.png",
            "ç¦»å­æ­¦å™¨ //2.0": "skin/skin26.png",
            "æ—¥å†•é›„ç‹®": "skin/skin23.png",
            "å¥‡å¹»æœ‹å…‹ //3.0": "skin/skin25.png",
            "èµ·æº": "skin/skin24.png",
            "è€€é³å¨é¾™": "skin/skin22.png"
        };

        // æ’åé¡¹èƒŒæ™¯å›¾ç‰‡è·¯å¾„æ˜ å°„ï¼ˆå«é»˜è®¤èƒŒæ™¯ï¼‰
        const RANKING_BACKGROUND_MAP = {
            default: "back/default_bg.jpg",
            "RGX 11z Pro": "back/back03.jpg",
            "æ å½±": "back/back02.jpg",
            "ç›–äºšçš„å¤ä»‡": "back/back04.jpg",
            "ç´«é˜™é‡‘ç…": "back/back05.jpg",
            "ORA x é¢—ç§’": "back/back06.jpg",
            "è‰¾æ²ƒè‰çš„æ¢¦ä¹‹ç¿¼": "back/back07.jpg",
            "è¶…æ—¶ç©ºå«é˜Ÿ": "back/back08.jpg",
            "ä¸Šå¤é¾™ç‚": "back/back09.jpg",
            "2021 å…¨çƒå† å†›èµ›": "back/back10.jpg",
            "2023 å…¨çƒå† å†›èµ›": "back/back11.jpg",
            "2025 å…¨çƒå† å†›èµ›": "back/back12.jpg",
            "åˆ›ãƒ»çºªå…ƒ": "back/back13.jpg",
            "å¤šå¼¥å°”çš„å¤ä»‡": "back/back01.jpg",
            "å…‰æ˜å“¨å…µ": "back/back14.jpg",
            "å…‰è£å¼‚è±¡": "back/back15.jpg",
            "å½’é›¶è€…": "back/back16.jpg",
            "æ´ªè’æ€’ç„°": "back/back17.jpg",
            "æ··æ²Œåºæ›²": "back/back18.jpg",
            "æœºåŠ¨ç‹‚é£™": "back/back19.jpg",
            "å¥‡ç‚¹ //2.0": "back/back20.jpg",
            "åƒçµåç»½ //2.0": "back/back21.png",
            "å™¬å½±è€…": "back/back37.jpg",
            "åŒåŸä¹‹æˆ˜": "back/back36.jpg",
            "å¡‘æ°´å®—": "back/back35.jpg",
            "å…¨æ¯æ³¢æ™® //2.0": "back/back38.jpg",
            "è™šç©ºé—è¿¹": "back/back34.jpg",
            "åƒæœˆè‹é¾™": "back/back33.jpg",
            "æ»‹æ»‹ X ç‰¹å·¥é˜Ÿ": "back/back32.jpg",
            "èˆ¬è‹¥å‡é¢ //2.0": "back/back31.jpg",
            "å†°ç‚¹å‡å†»": "back/back30.jpg",
            "å •å¤©é—æ­¦": "back/back29.jpg",
            "ç›–ä¸–è‹±é›„": "back/back28.jpg",
            "æµ·æ´‹ä¹‹æ˜Ÿ": "back/back27.jpg",
            "ç¦»å­æ­¦å™¨ //2.0": "back/back26.jpg",
            "æ—¥å†•é›„ç‹®": "back/back23.jpg",
            "å¥‡å¹»æœ‹å…‹ //3.0": "back/back25.jpg",
            "èµ·æº": "back/back24.jpg",
            "è€€é³å¨é¾™": "back/back22.jpg"
        };

        /**************************
         * å…¨å±€å˜é‡åŒº - çŠ¶æ€ç®¡ç†
         **************************/
        // å½“å‰æ‹–æ‹½çš„å…ƒç´ 
        let draggedElement = null;
        // æ˜¯å¦å·²æäº¤è¯„çº§
        let hasSubmitted = false;

        /**************************
         * å·¥å…·å‡½æ•°åŒº - é€šç”¨åŠŸèƒ½
         **************************/
        /**
         * æ˜¾ç¤ºæ¶ˆæ¯æç¤ºæ¡†
         * @param {string} text - æç¤ºæ–‡æœ¬
         * @param {string} type - æç¤ºç±»å‹ï¼ˆerror/successï¼‰
         */
        function showMessage(text, type) {
            const messageBox = document.getElementById('messageBox');
            messageBox.innerHTML = `<div class="message ${type}">${text}</div>`;
            setTimeout(() => {
                messageBox.innerHTML = '';
            }, 5000);
        }

        /**
         * åˆå§‹åŒ–å¾…é€‰åŒºæªçš®åˆ—è¡¨
         */
        function initWaitingArea() {
            const waitingArea = document.getElementById('waitingArea');
            waitingArea.innerHTML = '';
            
            SKINS.forEach(skin => {
                const card = createSkinCard(skin);
                waitingArea.appendChild(card);
            });
        }

        /**
         * åˆ›å»ºæªçš®å¡ç‰‡å…ƒç´ 
         * @param {string} skinName - æªçš®åç§°
         * @returns {HTMLElement} æªçš®å¡ç‰‡DOMå…ƒç´ 
         */
        function createSkinCard(skinName) {
            const card = document.createElement('div');
            card.className = 'skin-card';
            card.draggable = !hasSubmitted;
            card.dataset.skin = skinName;
            
            // æªçš®å›¾ç‰‡ï¼ˆå ä½å›¾ï¼‰
            const img = document.createElement('img');
            img.src = SKIN_IMAGE_MAP[skinName] || 'https://via.placeholder.com/120x150/2d3561/ffffff?text=é»˜è®¤';
            img.style.width = '120px';
            img.style.height = '150px';
            img.style.objectFit = 'cover';
            img.alt = skinName;
            img.className = 'skin-card-img';

            // æªçš®åç§°æ–‡æœ¬
            const text = document.createElement('span');
            text.textContent = skinName;

            // ç»„è£…å¡ç‰‡
            card.appendChild(img);
            card.appendChild(text);

            // ç»‘å®šæ‹–æ‹½äº‹ä»¶
            card.addEventListener('dragstart', handleDragStart);
            card.addEventListener('dragend', handleDragEnd);

            return card;
        }

        /**
         * ç¦ç”¨æ‰€æœ‰æªçš®å¡ç‰‡çš„æ‹–æ‹½åŠŸèƒ½
         */
        function disableDragging() {
            document.querySelectorAll('.skin-card').forEach(card => {
                card.draggable = false;
                card.style.cursor = 'not-allowed';
            });
        }

        /**
         * æ”¶é›†ç”¨æˆ·çš„è¯„çº§æ•°æ®
         * @returns {Object} è¯„çº§æ•°æ® { æªçš®åç§°: è¯„çº§ç­‰çº§ }
         */
        function collectRatings() {
            const ratings = {};
            
            document.querySelectorAll('.drop-zone').forEach(zone => {
                const tier = zone.dataset.tier;
                const skins = Array.from(zone.querySelectorAll('.skin-card')).map(card => card.dataset.skin);
                
                skins.forEach(skin => {
                    ratings[skin] = tier;
                });
            });

            // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰æªçš®éƒ½å·²è¯„çº§
            const unratedSkins = SKINS.filter(skin => !Object.keys(ratings).includes(skin));
            if (unratedSkins.length > 0) {
                showMessage(`è¿˜æœ‰ ${unratedSkins.length} ä¸ªæªçš®æœªè¯„çº§ï¼Œè¯·å…¨éƒ¨æ‹–æ‹½åˆ°å¯¹åº”ç­‰çº§ï¼`, 'error');
                return null;
            }

            return ratings;
        }

        /**
         * æäº¤è¯„çº§æ•°æ®åˆ°åç«¯
         */
        async function submitRatings() {
            // 1. ç¦æ­¢é‡å¤æäº¤
            if (hasSubmitted) {
                showMessage('æ‚¨å·²æäº¤è¿‡è¯„çº§ï¼Œæ— æ³•é‡å¤æäº¤ï¼', 'error');
                return;
            }

            // 2. æ”¶é›†è¯„çº§æ•°æ®
            const ratings = collectRatings();
            if (!ratings) return;

            try {
                // 3. è°ƒç”¨åç«¯æ¥å£æäº¤æ•°æ®
                const response = await fetch('/api/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(ratings)
                });

                const result = await response.json();

                // 4. å¤„ç†æäº¤ç»“æœ
                if (result.success) {
                    showMessage(result.msg, 'success');
                    hasSubmitted = true;
                    disableDragging();
                    document.getElementById('submitBtn').disabled = true;
                    
                    // æäº¤æˆåŠŸåè‡ªåŠ¨è·³è½¬åˆ°æ’è¡Œæ¦œ
                    setTimeout(() => {
                        switchToRankingPage();
                    }, 2000);
                } else {
                    showMessage(result.msg || 'æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•ï¼', 'error');
                }
            } catch (err) {
                console.error('æäº¤å¤±è´¥ï¼š', err);
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œæäº¤å¤±è´¥ï¼', 'error');
            }
        }

        /**
         * ä»åç«¯è·å–æ’è¡Œæ¦œæ•°æ®å¹¶å±•ç¤º
         */
        async function loadRankings() {
            try {
                const response = await fetch('/api/rankings');
                const result = await response.json();

                if (result.success) {
                    displayRankings(result.data);
                } else {
                    showMessage(result.msg || 'è·å–æ’è¡Œæ¦œå¤±è´¥ï¼', 'error');
                }
            } catch (err) {
                console.error('è·å–æ’è¡Œæ¦œå¤±è´¥ï¼š', err);
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•åŠ è½½æ’è¡Œæ¦œï¼', 'error');
            }
        }

        /**
         * æ˜¾ç¤ºæ’åæ•°æ®åˆ°é¡µé¢
         * @param {Array} rankings - åç«¯è¿”å›çš„æ’è¡Œæ¦œæ•°æ®
         */
        function displayRankings(rankings) {
            const rankingList = document.getElementById('rankingList');
            rankingList.innerHTML = '';

            // æ— æ•°æ®æ—¶æç¤º
            if (!rankings || rankings.length === 0) {
                rankingList.innerHTML = '<p style="text-align: center; color: #aaa;">æš‚æ— è¯„çº§æ•°æ®</p>';
                return;
            }

            // æ¸²æŸ“æ’åé¡¹
            rankings.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'ranking-item';
                // è·å–èƒŒæ™¯å›¾è·¯å¾„ï¼ˆä¼˜å…ˆæªçš®ä¸“å±ï¼Œæ— åˆ™ç”¨é»˜è®¤ï¼‰
                const bgImageUrl = RANKING_BACKGROUND_MAP[item.skin] || RANKING_BACKGROUND_MAP.default;
                // ç”¨CSSå˜é‡è®¾ç½®èƒŒæ™¯å›¾
                div.style.setProperty('--bg-image', `url('${bgImageUrl}')`);
                
                div.innerHTML = `
                    <span class="rank">#${index + 1}</span>
                    <div style="display: inline-block; vertical-align: top; width: calc(100% - 80px);">
                        <div class="skin-name">${item.skin}</div>
                        <div class="total-score">æ€»åˆ†: ${item.totalScore}</div>
                        <div class="rating-stats">
                            <span class="stat-item stat-s">Sçº§: ${item.stats.S || 0}</span>
                            <span class="stat-item stat-a">Açº§: ${item.stats.A || 0}</span>
                            <span class="stat-item stat-b">Bçº§: ${item.stats.B || 0}</span>
                            <span class="stat-item stat-c">Cçº§: ${item.stats.C || 0}</span>
                            <span class="stat-item stat-d">Dçº§: ${item.stats.D || 0}</span>
                        </div>
                    </div>
                `;
                rankingList.appendChild(div);
            });
        }

        /**
         * åˆ‡æ¢åˆ°æ’è¡Œæ¦œé¡µé¢
         */
        function switchToRankingPage() {
            document.getElementById('ratingPage').style.display = 'none';
            document.getElementById('rankingPage').classList.add('active');
            // åŠ è½½æ’è¡Œæ¦œæ•°æ®
            loadRankings();
        }

        /**
         * åˆ‡æ¢å›è¯„çº§é¡µé¢
         */
        function switchToRatingPage() {
            document.getElementById('rankingPage').classList.remove('active');
            document.getElementById('ratingPage').style.display = 'block';
        }

        /**************************
         * æ‹–æ‹½äº‹ä»¶å¤„ç†åŒº - æ ¸å¿ƒäº¤äº’
         **************************/
        /**
         * å¤„ç†æ‹–æ‹½å¼€å§‹äº‹ä»¶
         * @param {DragEvent} e - æ‹–æ‹½äº‹ä»¶å¯¹è±¡
         */
        function handleDragStart(e) {
            if (hasSubmitted) {
                e.preventDefault();
                return;
            }
            draggedElement = this;
            this.classList.add('dragging');
            e.dataTransfer.setData('text/plain', this.dataset.skin);
            e.dataTransfer.effectAllowed = 'move';
        }

        /**
         * å¤„ç†æ‹–æ‹½ç»“æŸäº‹ä»¶
         * @param {DragEvent} e - æ‹–æ‹½äº‹ä»¶å¯¹è±¡
         */
        function handleDragEnd(e) {
            this.classList.remove('dragging');
            draggedElement = null;
            // ç§»é™¤æ‰€æœ‰æ‹–æ”¾åŒºåŸŸçš„é«˜äº®
            document.querySelectorAll('.rating-box').forEach(box => {
                box.classList.remove('drag-over');
            });
        }

        /**
         * å¤„ç†æ‹–æ”¾åŒºåŸŸçš„æ‹–æ‹½è¿›å…¥äº‹ä»¶
         * @param {DragEvent} e - æ‹–æ‹½äº‹ä»¶å¯¹è±¡
         */
        function handleDragOver(e) {
            e.preventDefault(); // å…è®¸æ”¾ç½®
            const dropZone = e.target.closest('.drop-zone');
            if (dropZone && !hasSubmitted) {
                const ratingBox = dropZone.closest('.rating-box');
                ratingBox.classList.add('drag-over');
            }
        }

        /**
         * å¤„ç†æ‹–æ”¾åŒºåŸŸçš„æ‹–æ‹½ç¦»å¼€äº‹ä»¶
         * @param {DragEvent} e - æ‹–æ‹½äº‹ä»¶å¯¹è±¡
         */
        function handleDragLeave(e) {
            const dropZone = e.target.closest('.drop-zone');
            if (dropZone) {
                const ratingBox = dropZone.closest('.rating-box');
                // ç¡®ä¿é¼ æ ‡çœŸçš„ç¦»å¼€åŒºåŸŸæ‰ç§»é™¤é«˜äº®
                const relatedTarget = e.relatedTarget;
                if (!ratingBox.contains(relatedTarget)) {
                    ratingBox.classList.remove('drag-over');
                }
            }
        }

        /**
         * å¤„ç†æ‹–æ”¾åŒºåŸŸçš„æ”¾ç½®äº‹ä»¶
         * @param {DragEvent} e - æ‹–æ‹½äº‹ä»¶å¯¹è±¡
         */
        function handleDrop(e) {
            e.preventDefault();
            if (hasSubmitted || !draggedElement) return;

            const dropZone = e.target.closest('.drop-zone');
            if (dropZone) {
                // ç§»é™¤æ‹–æ”¾åŒºåŸŸé«˜äº®
                const ratingBox = dropZone.closest('.rating-box');
                ratingBox.classList.remove('drag-over');
                
                // æŠŠæ‹–æ‹½çš„å¡ç‰‡æ·»åŠ åˆ°å½“å‰æ‹–æ”¾åŒºåŸŸ
                dropZone.appendChild(draggedElement);
                // é‡ç½®å¡ç‰‡æ ·å¼
                draggedElement.classList.remove('dragging');
            }
        }

        /**************************
         * é¡µé¢åˆå§‹åŒ– - å…¥å£å‡½æ•°
         **************************/
        function initPage() {
            // 1. åˆå§‹åŒ–å¾…é€‰åŒºæªçš®
            initWaitingArea();

            // 2. ç»‘å®šæ‹–æ”¾åŒºåŸŸäº‹ä»¶
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });

            // 3. ç»‘å®šæäº¤æŒ‰é’®äº‹ä»¶
            document.getElementById('submitBtn').addEventListener('click', submitRatings);

            // 4. ç»‘å®šè¿”å›æŒ‰é’®äº‹ä»¶
            document.getElementById('backBtn').addEventListener('click', (e) => {
                e.preventDefault();
                switchToRatingPage();
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
